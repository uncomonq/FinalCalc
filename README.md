# üìê FinalCalc

**FinalCalc** ‚Äî —ç—Ç–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π. –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∞ –Ω–∞ Go –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç gRPC, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ REST API –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.

---

## üß∞ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –í–≤–æ–¥ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ API
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ gRPC-—Å–µ—Ä–≤–∏—Å
- –†–∞—Å—à–∏—Ä—è–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ –ø–∞–∫–µ—Ç–∞–º
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–æ–º–æ—â—å—é Postman

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ **Windows** –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

- [Go 1.20+](https://golang.org/dl/)
- [TDM-GCC](https://jmeubank.github.io/tdm-gcc/) **(–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è —Å–±–æ—Ä–∫–∏ –Ω–∞ Windows, —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `cgo`)**
- [Postman](https://www.postman.com/) –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
git clone https://github.com/uncomonq/FinalCalc.git
cd FinalCalc
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
go mod tidy
```
### 3. –ó–∞–ø—É—Å–∫

```bash
go run cmd/main.go
```
### –í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

http://localhost:8080/api/v1/web

### –¢–µ—Å—Ç—ã

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–∞–∫—É—é –∫–æ–º–∞–Ω–¥—É:
```bash
go test ./internal/application
```
### –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥

**HOST**=localhost, –∞ **PORT**=8080

```
curl --location 'http://localhost:8080/api/v1/register' \ // 
--header 'Content-Type: application/json' \
--data '{
  "login": <–ª–æ–≥–∏–Ω>,
  "password": <–ø–∞—Ä–æ–ª—å>,
}'
```
###### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å **POST** –Ω–∞ ```/api/v1/register``` —Å —Ç–µ–ª–æ–º:
```
{ "login": <–ª–æ–≥–∏–Ω>, "password": <–ø–∞—Ä–æ–ª—å>}
```

–í –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–∞–µ—Ç 200 OK –∏–ª–∏ 422 –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏:

- **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥**(—Ç–æ–ª—å–∫–æ **POST**): ```method not allowed```.
- **–ù–µ–≤–µ—Ä–Ω–æ–µ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** ```invalid body```.
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:** ```user already exists```.
- **–ö–æ—Ä–æ—Ç–∫–∏–π –ø–∞—Ä–æ–ª—å** (–º–µ–Ω—å—à–µ *5 —Å–∏–º–≤–æ–ª–æ–≤*): ```short password```.

```
curl --location 'http://localhost:8080/api/v1/login' \
--header 'Content-Type: application/json' \
--data '{
  "login": <–ª–æ–≥–∏–Ω>,
  "password": <–ø–∞—Ä–æ–ª—å>,
}'
```
###### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å **POST** –Ω–∞ ```/api/v1/login``` —Å —Ç–µ–ª–æ–º:
```
{ "login": <–ª–æ–≥–∏–Ω>, "password":<–ø–∞—Ä–æ–ª—å> }
```
- –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞:
```
{"access_token": <—Ç–æ–∫–µ–Ω>}
```

–í –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–∞–µ—Ç 200 OK –∏ **JWT-—Ç–æ–∫–µ–Ω –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**, 422 –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏.

- **–ù–µ–≤–µ—Ä–Ω—ã–π –º–µ—Ç–æ–¥**(–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **—Ç–æ–ª—å–∫–æ POST**): ```method not allowed```
- **–ù–µ–≤–µ—Ä–Ω–æ–µ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** ```invalid body```
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω:** ```invalid login or password```

–î–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –∫—Ä–æ–º–µ **login** –∏ **register**, –Ω—É–∂–µ–Ω Authorization:
```
Authorization: Bearer <–ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø—Ä–∏ login —Ç–æ–∫–µ–Ω>
```

 - –ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω: ```invalid header```.
 - –¢–æ–∫–µ–Ω –Ω–µ –≤–µ—Ä–Ω—ã–π: ```invalid token```.

#### –í—ã—á–∏—Å–ª–µ–Ω–∏—è

```
curl --location 'http://localhost:8080/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
  "expression": <–≤—ã—Ä–∞–∂–µ–Ω–∏–µ>
}'
```

##### –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–∞: 
 - 201 - –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
 - 422 - –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
 - 500 - —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

##### –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞

```
{
    "id": <—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—ã—Ä–∞–∂–µ–Ω–∏—è> // –µ–≥–æ ID
}
```

##### –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞:

–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π(**ID** –Ω–µ –Ω—É–∂–µ–Ω).

```
{
    "expressions": [
        {
            "id": 2352351,
            "status": "OK",  // –≥–æ—Ç–æ–≤–æ
            "result": 3
            "error": ""
        },
        
            "id": 5372342,
            "status": "Calculation",  // –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
            "result": 3
            "error": ""
        },
        {
            "id": 8251431,
            "status": "error",  // —Å—Ç–∞—Ç—É—Å –æ—à–∏–±–∫–∏
            "result": 0
            "error": "someting error"
        },
        {
            "id": 34942763,
            "status": "Wait", // –∂–¥—ë—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            "result": 0
            "error": ""
        }
    ]
}
```
##### –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–∞:
 - 200 - —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω —Å–ø–∏—Å–æ–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–π
 - 500 - —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ø–æ –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É

```
curl --location 'http://localhost:8080/api/v1/expressions/<id –≤—ã—Ä–∞–∂–µ–Ω–∏—è>'
```

##### –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞:

```
{
    "expression":
        {
            "id": <–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—ã—Ä–∞–∂–µ–Ω–∏—è>,
            "status": <—Å—Ç–∞—Ç—É—Å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã—Ä–∞–∂–µ–Ω–∏—è>,
            "result": <—Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è>
        }
}
```

##### –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–∞:
 - 200 - —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
 - 404 - –Ω–µ—Ç —Ç–∞–∫–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
 - 500 - —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### –ù–∞–≥–ª—è–¥–Ω—ã–π –ø—Ä–∏–º–µ—Ä (–∫–æ–ø–∏—Ä—É–π—Ç–µ curl –∏ –ø—Ä–æ–±—É–π—Ç–µ)

```
curl --location 'http://localhost:8080/api/v1/register' \
--header 'Content-Type: application/json' \
--data '{
  "login": "user0",
  "password": "user0_password"
}'
```

```
curl --location 'http://localhost:8080/api/v1/login' \ // 
--header 'Content-Type: application/json' \
--data '{
  "login": "user0",
  "password": "user0_password"
}'
```
–°—á–∏—Ç—ã–≤–∞–µ–º –∏–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞ —Ç–æ–∫–µ–Ω.

```
curl --location 'http://localhost:8080/api/v1/calculate' \
--header 'Content-Type: application/json' --header 'Authorization: Bearer <—Ç–æ–∫–µ–Ω>' \
--data '{
  "expression": "2+2/2"
}'
```

##### –û—Ç–≤–µ—Ç
–°—Ç–∞—Ç—É—Å 201(—É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ);
```
{
    "id": 12345 // –ø—Ä–∏–º–µ—Ä
}
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ø–æ ID

```
curl --location 'localhost:8080/api/v1/expressions/12345'
```

##### –û—Ç–≤–µ—Ç
–°—Ç–∞—Ç—É—Å 200(—É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–æ);
```
{
    "expression":
        {
            "id": 12345,
            "status": "OK",
            "result": 321
        }
}
```

#### –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è

```
curl --location 'http://localhost:8080/api/v1/expressions'
--header 'Authorization: Bearer <—Ç–æ–∫–µ–Ω>'
```

##### –û—Ç–≤–µ—Ç
–°—Ç–∞—Ç—É—Å 200(—É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω—ã);
```
{
    "expressions": [
        {
            "id": 12345,
            "status": "OK",
            "result": 321
        },
    ]
}
```
